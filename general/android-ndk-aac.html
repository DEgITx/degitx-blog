<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link href="https://fonts.googleapis.com/css?family=Saira&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Overpass+Mono|Source+Code+Pro&display=swap" rel="stylesheet">

    <title>Android NDK AAC decoder ADTS alignment | Alexey Kasyanchuk &mdash; Senior Software Developer </title>
    <meta property="og:title" content="Android NDK AAC decoder ADTS alignment | Alexey Kasyanchuk &mdash; Senior Software Developer " />
    <meta name="twitter:title" content="Android NDK AAC decoder ADTS alignment | Alexey Kasyanchuk &mdash; Senior Software Developer " />

    <meta name="description" content="Alexey Kasyanchuk NDK SoftAAC2 align basics.">
    <meta name="description" property="og:description" content="Alexey Kasyanchuk NDK SoftAAC2 align basics." />
    <meta name="twitter:description" content="Alexey Kasyanchuk NDK SoftAAC2 align basics." />
    <meta name="keywords" content="C, C++, Java, Python, Performance, Android, Java, Git, Github, StackOverflow, algorithm, Qt, DEgITx, Kasyanchuk, Gitlab" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@degitx" />
    
    <meta property="og:url" content="https://blog.degitx.com/general/android-ndk-aac.html" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Alexey Kasyanchuk" />

    <meta name="copyright" content="Copyright by Alexey Kasyanchuk. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.png" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="https://blog.degitx.com/assets/css/main.css">

    <link rel="canonical" href="https://blog.degitx.com/general/android-ndk-aac.html">

    <link rel="alternate" type="application/rss+xml" title="" href="https://blog.degitx.com/feed.xml">

    <script src="https://blog.degitx.com/assets/js/jquery-1.12.2.min.js"></script>
<script src="https://blog.degitx.com/assets/js/backtotop.js"></script>
<script src="https://blog.degitx.com/assets/js/lunr.min.js"></script>
<script src="https://blog.degitx.com/assets/js/lunr-feed.js"></script>
<script src="https://blog.degitx.com/assets/js/jquery.fitvids.js"></script>
<script src="https://blog.degitx.com/assets/js/svg4everybody.min.js"></script>
<script src="https://blog.degitx.com/assets/js/scripts.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NF83F10V5F"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-NF83F10V5F');
    </script>


<script>
const host_address = "https://blog.degitx.com".replace('https://', '');
if (window.location.host == host_address && window.location.protocol == "http:") {
  window.location.protocol = "https:"
}
</script>

</head>

    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="https://blog.degitx.com"><img alt="Avatar" src="/degitx.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Alexey Kasyanchuk</strong>
            <span class="my-job-title">Senior Software Developer</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="/" >Blog</a>
            
                
            
                
            
                
            
                
                    <a href="https://blog.degitx.com/resume/" >About</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    

    <p class="about-me">Alexey Kasyanchuk - Senior Software Engineer with 10 years of expiriece in C/C++, Java, Python. I share expiriece.</p>

    <ul class="socials">
        <li class="twitter"><a href="http://twitter.com/DEgITx"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://blog.degitx.com/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li class="github"><a href="http://github.com/DEgITx"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://blog.degitx.com/assets/svg/social-icons.svg#github-icon"></use></svg></a></li><li class="linkedin"><a href="https://www.linkedin.com/in/alexey-kasyanchuk-60301456/"><svg title="linkedin" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://blog.degitx.com/assets/svg/social-icons.svg#linkedin-icon"></use></svg></a></li><li class="stack-overflow"><a href="https://stackoverflow.com/users/1315059/degitx"><svg title="stack-overflow" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://blog.degitx.com/assets/svg/social-icons.svg#stack-overflow-icon"></use></svg></a></li>

        
            <li class="email"><a href="mailto:degitx@gmail.com"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://blog.degitx.com/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li class="rss-feed"><a href="https://blog.degitx.com/feed.xml"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://blog.degitx.com/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>

            <main class="the-content" role="main">
                
                <article class="post single" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2020-07-15T23:32:00+00:00" itemprop="datePublished">15 Jul, 2020</time></li>
            
                
                <li class="cats">
                    
                        <a href="/categories/general/">general</a>
                    
                </li>
                
            
        </ul>
        <h2 itemprop="name headline">Android NDK AAC decoder ADTS alignment</h2>
    </header>

    <div class="post-content">
        <p>After a long thought, I finally decided to switch my blog articles to english, and continue to give some rare and mostly unintresting info in free form. And today we will talk more about Android, NDK and some undocumentated video/audio functionality, maybe will discover some new knowlage about AAC and maybe it will help your own problem, like it was for me.
In a focus of this acrticle is Android AAC decoder, and a little detail how the decoding in android working behind NDK documentation.</p>

<h3 id="amediacodec-using-steps">AMediaCodec using steps</h3>

<p>First let take a very very surface look how to start decoding using NDK:</p>
<ol>
  <li>Create AMediaCodec using codec name.</li>
  <li>Configure AMediaCodec via AMediaCodec_configure.</li>
  <li>Ctart decoding AMediaCodec_start.</li>
  <li>Give a buffer using AMediaCodec_getInputBuffer.</li>
  <li>Back buffer with AMediaCodec_queueInputBuffer.</li>
  <li>Repeat while you have an buffer ;).</li>
</ol>

<p>Looks very simple, and work good as well. I can end this article in this place, but I don’t tell you nothing about buffer requirenments and other stuffs, and in NDK/SDK also all simple like that. So what going on behind this android decoding? What if you getting some error with your buffer, or you don’t have sound in some rare cases? How the Android decoder works like, let take a look at AAC audio decoder as example. Let’s begin from simple.</p>

<figure>
	<img src="/images/ndk-acc/download.jpg" />
	<figcaption>Android AAC decoder architecture</figcaption>
</figure>

<p>As you see on this bad jpeg picture :) Android have different implementation of AAC decoders as OMX components. But that’s not all, beside some software implemetation on some platforms existed hardware implementation, like on Broadcom chips. Keep at mind, and will transport to SoftAAC2 decoder. Let take a look deeper.</p>

<!--more-->

<h3 id="softaac2">SoftAAC2</h3>

<figure>
	<img src="/images/ndk-acc/VS7-04-AAC-Decord-flow.png" />
	<figcaption>SoftAAC2 decoder stack</figcaption>
</figure>

<p>In the deep level we finally see SoftAAC2 decoder, now it’s looks not so simple like “start AAC decoder” isn’t it? :) But we finally know how the buffer transfer from decoder to upper of ACodec abstraction. 
Now we know a little about SoftAAC2 (that default software AAC decoder). Now let’s expand knowledges about how ADTS AAC packets looks like. This is a good representation of it:</p>

<figure>
	<img src="/images/ndk-acc/VS7-02-AAC-ADTS-hejunlin.png" />
	<figcaption>AAC-ADTS sequence</figcaption>
</figure>

<p>As you see on bottom very important info, that protection_absent flag is very important and based of it header can be 7 bytes or 9 bytes length.
Ok now it is time to talk about main theme of this article - ADTS alignment.</p>

<figure>
	<img src="/images/ndk-acc/VS7-02-AAC-ADTS-hejunlin_cplit.png" />
	<figcaption>AAC-ADTS align</figcaption>
</figure>

<p>This is very typical example how your receiver can get the buffer, without any knowledge about buffer encoder alignment requirements. So what you can do in such situation when packets not align properly?
Let’s realign frames according proper requirements for all decoders to make buffer splitted to complete AAC frame chunks.</p>

<h3 id="aac-adts-align">AAC-ADTS align</h3>

<p>First of all, lets detect AAC header beginning:</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre><span class="k">if</span> <span class="p">((</span><span class="mh">0xFF</span> <span class="o">==</span> <span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="mh">0xF9</span> <span class="o">==</span> <span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">||</span> <span class="p">(</span><span class="mh">0xF1</span> <span class="o">==</span> <span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">1</span><span class="p">])))</span>
<span class="p">{</span>
 <span class="c1">// This AAC header start</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Now let’s detect AAC ES frame size according frame header data:</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre><span class="kt">unsigned</span> <span class="n">aac_frame_length</span> <span class="o">=</span>
                    <span class="p">((</span><span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">11</span><span class="p">)</span>
                    <span class="o">|</span> <span class="p">(</span><span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span>
                    <span class="o">|</span> <span class="p">(</span><span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Where offset can be any lookup counter. It’s time to copy the frame data into some buffer struct with size+buffer parts.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre><span class="n">BufferedFrame</span> <span class="n">aacFrame</span><span class="p">;</span>
<span class="n">aacFrame</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">aac_frame_length</span><span class="p">;</span>
<span class="c1">// Don't forget to allocate aacFrame.buffer!</span>
<span class="n">memcpy</span><span class="p">(</span><span class="n">aacFrame</span><span class="p">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">frameBuffer</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">aac_frame_length</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Continue until you reach the frame end. Don’t forget to handle end buffer parts, and concat with new one at endings and beginnings.
Full ADTS alignment algorithm will be follow:</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="code"><pre><span class="kt">ssize_t</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">vector</span> <span class="n">frames</span><span class="p">;</span>

<span class="c1">// copy_at_end and copy_at_begin - are pseudocode to copy left part of the incomplete buffer </span>
<span class="c1">// and finish it with right part of next buffer chunk</span>

<span class="c1">// copy left part of (aac_frame_length - mResSize)</span>
<span class="c1">// increase offset += (aac_frame_length - mResSize)</span>
<span class="c1">// reset mRes = false;</span>
<span class="c1">// Concat partiticial buffers from copy_at_begin with copy_at_end to make complete aac packet</span>
<span class="k">if</span><span class="p">(</span><span class="n">mRes</span><span class="p">)</span>
    <span class="n">copy_at_end</span><span class="p">(</span><span class="n">halFrameBuffer</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">frameBufferSize</span> <span class="o">-</span> <span class="n">offset</span><span class="p">);</span> <span class="c1">// to to some restore buffer</span>

<span class="k">while</span><span class="p">(</span><span class="n">offset</span> <span class="o">&lt;</span> <span class="n">frameBufferSize</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="mh">0xFF</span> <span class="o">==</span> <span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="mh">0xF9</span> <span class="o">==</span> <span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">||</span> <span class="p">(</span><span class="mh">0xF1</span> <span class="o">==</span> <span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">1</span><span class="p">])))</span>
    <span class="p">{</span>
        <span class="kt">unsigned</span> <span class="n">aac_frame_length</span> <span class="o">=</span>
                    <span class="p">((</span><span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">11</span><span class="p">)</span>
                    <span class="o">|</span> <span class="p">(</span><span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span>
                    <span class="o">|</span> <span class="p">(</span><span class="n">frameBuffer</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">aac_frame_length</span> <span class="o">&lt;=</span> <span class="n">frameBufferSize</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">BufferedFrame</span> <span class="n">aacFrame</span><span class="p">;</span>
            <span class="c1">// You can allocate any own buffer array for handle new buffer before!</span>
            <span class="n">aacFrame</span><span class="p">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">localBuf</span><span class="p">[</span><span class="n">num</span><span class="o">++</span><span class="p">];</span>
            <span class="n">aacFrame</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">aac_frame_length</span><span class="p">;</span>
            <span class="n">memcpy</span><span class="p">(</span><span class="n">aacFrame</span><span class="p">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">frameBuffer</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">aac_frame_length</span><span class="p">);</span>
            <span class="n">frames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">aacFrame</span><span class="p">);</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">aac_frame_length</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="c1">// mRes, mResSize - global ones</span>
            <span class="n">mRes</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="n">mResSize</span> <span class="o">=</span> <span class="n">frameBufferSize</span> <span class="o">-</span> <span class="n">offset</span>
            <span class="n">copy_at_begin</span><span class="p">(</span><span class="n">halFrameBuffer</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">mResSize</span><span class="p">);</span> <span class="c1">// to to some restore buffer</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">offset</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Algorithm has linear time</p>

    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Android NDK AAC decoder ADTS alignment&p[summary]=After a long thought, I finally decided to switch my blog articles to english, and continue to give some rare and mostly unintresting inf...&p[url]=https://blog.degitx.com/general/android-ndk-aac.html" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://blog.degitx.com/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=https://blog.degitx.com/general/android-ndk-aac.html&text=After a long thought, I finally decided to switch my blog articles to english, and continue to give some rare and mostly unintresting inf...&hashtags=android,sdk,ndk,C++,aac,algorithm," rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://blog.degitx.com/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
                <li><a href="https://blog.degitx.com/tag/android">android</a></li>
                
                <li><a href="https://blog.degitx.com/tag/sdk">sdk</a></li>
                
                <li><a href="https://blog.degitx.com/tag/ndk">ndk</a></li>
                
                <li><a href="https://blog.degitx.com/tag/C++">C++</a></li>
                
                <li><a href="https://blog.degitx.com/tag/aac">aac</a></li>
                
                <li><a href="https://blog.degitx.com/tag/algorithm">algorithm</a></li>
                
            </ul>
        </div>
        
    </footer>
</article>


<aside class="comments" role="complementary">
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = 'https://blog.degitx.com/general/android-ndk-aac.html';
            this.page.identifier = '7/15/2020';
        };
        (function() {
            var d = document, s = d.createElement('script');

            s.src = '//degitx.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
</aside>

            </main>
        </div>
    </body>
</html>